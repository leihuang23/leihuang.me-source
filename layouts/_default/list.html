{{- define "main" }} {{- if (and site.Params.profileMode.enabled .IsHome) }} {{-
partial "index_profile.html" . }} {{- else }} {{/* if not profileMode */}} {{-
if not .IsHome | and .Title }}
<header class="page-header">
  {{- partial "breadcrumbs.html" . }}
  <h1>
    {{ .Title }} {{- if and (or (eq .Kind `term`) (eq .Kind `section`)) (.Param
    "ShowRssButtonInSectionTermList") }} {{- with .OutputFormats.Get "rss" }}
    <a href="{{ .RelPermalink }}" title="RSS" aria-label="RSS">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        height="23"
      >
        <path d="M4 11a9 9 0 0 1 9 9" />
        <path d="M4 4a16 16 0 0 1 16 16" />
        <circle cx="5" cy="19" r="1" />
      </svg>
    </a>
    {{- end }} {{- end }}
  </h1>
  {{- if .Description }}
  <div class="post-description">{{ .Description | markdownify }}</div>
  {{- end }}
</header>
{{- end }} {{- if .Content }}
<div class="post-content">
  {{- if not (.Param "disableAnchoredHeadings") }} {{- partial
  "anchored_headings.html" .Content -}} {{- else }}{{ .Content }}{{ end }}
</div>
{{- end }} {{- $pages := union .RegularPages .Sections }} {{- if .IsHome }} {{-
$pages = where site.RegularPages "Type" "in" site.Params.mainSections }} {{-
$pages = where $pages "Params.hiddenInHomeList" "!=" "true" }} {{- end }} {{-
$paginator := .Paginate $pages }} {{- if and .IsHome site.Params.homeInfoParams
(eq $paginator.PageNumber 1) }}
<div id="canvas-container">
  <button id="fullScreenBtn" title="Toggle fullscreen">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      viewBox="0 0 24 24"
      width="24"
      height="24"
    >
      <path
        fill="currentColor"
        d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"
      />
    </svg>
  </button>
  <canvas id="canvas1"></canvas>
</div>
<style>
  #canvas-container {
    position: relative;
  }
  #canvas1 {
    width: 100%;
    height: auto;
    display: block;
    margin: 0;
    background: #111;
  }
  #fullScreenBtn {
    position: absolute;
    top: 10px;
    right: 10px;
    background-color: #111;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    padding: 6px 12px;
    z-index: 10;
  }
  .fullscreen {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    z-index: 9999 !important;
    background-color: #111;
  }
</style>
<script>
  const canvas = document.getElementById("canvas1");
  const ctx = canvas.getContext("2d");
  const canvasContainer = document.getElementById("canvas-container");
  const fullScreenBtn = document.getElementById("fullScreenBtn");

  fullScreenBtn.addEventListener("click", function () {
    canvasContainer.classList.toggle("fullscreen");
    requestAnimationFrame(() => {
      window.dispatchEvent(new Event("resize"));
    });
  });
  const coordinates = [
    [37, 117],
    [36, 116],
    [35, 115],
    [34, 115],
    [34, 114],
    [34, 113],
    [35, 112],
    [36, 110],
    [38, 109],
    [40, 107],
    [43, 105],
    [46, 103],
    [50, 102],
    [54, 100],
    [58, 98],
    [63, 97],
    [68, 96],
    [73, 95],
    [78, 95],
    [83, 95],
    [88, 95],
    [93, 96],
    [97, 97],
    [101, 99],
    [105, 102],
    [109, 105],
    [113, 109],
    [117, 114],
    [120, 119],
    [123, 126],
    [125, 133],
    [127, 142],
    [129, 151],
    [130, 160],
    [131, 170],
    [132, 181],
    [132, 191],
    [131, 201],
    [130, 210],
    [128, 218],
    [126, 226],
    [124, 233],
    [121, 241],
    [117, 248],
    [113, 253],
    [109, 258],
    [104, 262],
    [99, 265],
    [94, 268],
    [88, 270],
    [83, 271],
    [78, 272],
    [74, 271],
    [70, 270],
    [66, 267],
    [62, 263],
    [59, 257],
    [56, 251],
    [53, 245],
    [51, 240],
    [50, 236],
    [49, 233],
    [49, 230],
    [50, 228],
    [52, 226],
    [54, 224],
    [57, 221],
    [61, 218],
    [65, 215],
    [69, 212],
    [73, 210],
    [78, 208],
    [83, 207],
    [88, 206],
    [93, 206],
    [99, 205],
    [106, 205],
    [112, 204],
    [118, 203],
    [124, 202],
    [130, 201],
    [136, 199],
    [143, 197],
    [149, 195],
    [155, 193],
    [161, 190],
    [166, 188],
    [171, 186],
    [176, 183],
    [180, 179],
    [184, 174],
    [188, 169],
    [192, 164],
    [195, 159],
    [199, 153],
    [202, 147],
    [205, 141],
    [207, 134],
    [209, 127],
    [211, 120],
    [212, 114],
    [213, 109],
    [213, 104],
    [213, 99],
    [214, 95],
    [214, 91],
    [214, 88],
    [214, 85],
    [214, 83],
    [214, 82],
    [213, 81],
    [212, 81],
    [211, 81],
    [210, 81],
    [209, 82],
    [208, 84],
    [208, 86],
    [207, 88],
    [207, 91],
    [206, 94],
    [205, 97],
    [204, 101],
    [203, 106],
    [202, 112],
    [201, 118],
    [199, 125],
    [198, 132],
    [197, 138],
    [196, 144],
    [195, 151],
    [194, 157],
    [193, 164],
    [192, 171],
    [192, 178],
    [191, 185],
    [191, 191],
    [191, 197],
    [191, 203],
    [191, 209],
    [191, 214],
    [191, 220],
    [191, 226],
    [191, 233],
    [191, 241],
    [191, 248],
    [191, 254],
    [191, 259],
    [191, 263],
    [191, 268],
    [192, 273],
    [192, 277],
    [193, 280],
    [193, 283],
    [194, 285],
    [195, 286],
    [196, 287],
    [197, 288],
    [198, 288],
    [199, 289],
    [200, 289],
    [201, 289],
    [202, 289],
    [204, 288],
    [205, 287],
    [207, 285],
    [209, 283],
    [211, 280],
    [213, 278],
    [215, 276],
    [217, 274],
    [219, 272],
    [221, 270],
    [224, 268],
    [226, 267],
    [229, 265],
    [231, 262],
    [234, 259],
    [238, 256],
    [241, 253],
    [244, 251],
    [248, 249],
    [251, 247],
    [254, 246],
    [257, 244],
    [260, 242],
    [263, 240],
    [267, 237],
    [270, 234],
    [274, 232],
    [277, 229],
    [280, 227],
    [283, 225],
    [286, 222],
    [288, 219],
    [290, 216],
    [293, 212],
    [295, 208],
    [297, 204],
    [299, 201],
    [300, 198],
    [300, 195],
    [300, 192],
    [299, 189],
    [298, 187],
    [296, 185],
    [294, 183],
    [291, 182],
    [288, 180],
    [285, 179],
    [282, 178],
    [279, 177],
    [276, 177],
    [273, 178],
    [270, 179],
    [267, 181],
    [264, 183],
    [261, 185],
    [259, 188],
    [257, 192],
    [255, 196],
    [254, 200],
    [253, 205],
    [252, 210],
    [251, 215],
    [250, 220],
    [250, 226],
    [250, 232],
    [250, 238],
    [250, 244],
    [251, 250],
    [252, 256],
    [253, 262],
    [254, 266],
    [256, 270],
    [258, 273],
    [261, 275],
    [263, 278],
    [266, 280],
    [269, 281],
    [273, 283],
    [277, 284],
    [281, 284],
    [285, 283],
    [290, 280],
    [295, 277],
    [300, 273],
    [306, 269],
    [311, 264],
    [317, 259],
    [323, 254],
    [328, 249],
    [334, 243],
    [340, 236],
    [345, 227],
    [351, 218],
    [356, 208],
    [361, 199],
    [366, 190],
    [370, 181],
    [374, 171],
    [378, 161],
    [382, 151],
    [385, 142],
    [388, 135],
    [391, 129],
    [393, 124],
    [394, 120],
    [395, 118],
    [396, 116],
    [397, 114],
    [397, 113],
    [397, 111],
    [397, 110],
    [397, 109],
    [397, 108],
    [397, 107],
    [396, 107],
    [395, 107],
    [394, 107],
    [393, 107],
    [392, 107],
    [391, 107],
    [391, 108],
    [390, 108],
    [389, 109],
    [388, 111],
    [386, 113],
    [384, 115],
    [382, 118],
    [380, 120],
    [378, 123],
    [376, 126],
    [374, 129],
    [372, 133],
    [370, 137],
    [368, 141],
    [366, 146],
    [364, 150],
    [362, 155],
    [361, 160],
    [359, 164],
    [358, 169],
    [357, 174],
    [356, 179],
    [355, 184],
    [353, 190],
    [352, 197],
    [351, 203],
    [350, 209],
    [349, 215],
    [348, 220],
    [348, 226],
    [348, 231],
    [348, 236],
    [349, 240],
    [350, 244],
    [351, 249],
    [352, 253],
    [354, 256],
    [356, 258],
    [358, 259],
    [361, 260],
    [364, 260],
    [366, 260],
    [369, 260],
    [373, 260],
    [376, 259],
    [380, 257],
    [384, 254],
    [388, 250],
    [392, 245],
    [396, 238],
    [401, 231],
    [406, 223],
    [411, 213],
    [417, 203],
    [422, 193],
    [427, 182],
    [433, 170],
    [438, 159],
    [443, 149],
    [447, 140],
    [451, 131],
    [455, 123],
    [458, 117],
    [461, 111],
    [464, 107],
    [466, 104],
    [467, 101],
    [467, 100],
    [467, 99],
    [466, 99],
    [465, 98],
    [464, 98],
    [463, 98],
    [462, 98],
    [461, 98],
    [460, 98],
    [459, 99],
    [458, 100],
    [456, 101],
    [454, 102],
    [452, 104],
    [450, 106],
    [448, 108],
    [445, 111],
    [443, 114],
    [441, 118],
    [438, 121],
    [435, 125],
    [433, 128],
    [431, 131],
    [429, 135],
    [428, 138],
    [426, 141],
    [425, 145],
    [424, 149],
    [423, 153],
    [422, 158],
    [420, 163],
    [419, 169],
    [417, 176],
    [416, 182],
    [415, 188],
    [414, 194],
    [413, 201],
    [413, 208],
    [412, 215],
    [411, 222],
    [410, 228],
    [410, 234],
    [409, 240],
    [409, 245],
    [409, 249],
    [409, 253],
    [410, 256],
    [411, 259],
    [412, 261],
    [414, 263],
    [416, 265],
    [418, 266],
    [421, 267],
    [424, 267],
    [427, 265],
    [431, 263],
    [435, 259],
    [440, 254],
    [445, 248],
    [450, 242],
    [455, 236],
    [459, 230],
    [464, 223],
    [468, 216],
    [473, 207],
    [478, 198],
    [482, 189],
    [487, 180],
    [492, 171],
    [496, 163],
    [499, 157],
    [502, 154],
    [503, 151],
    [503, 150],
    [503, 149],
    [503, 148],
    [504, 146],
    [504, 145],
    [505, 143],
    [505, 142],
    [504, 141],
    [504, 142],
    [503, 143],
    [502, 144],
    [502, 146],
    [501, 148],
    [500, 150],
    [499, 153],
    [497, 156],
    [496, 160],
    [494, 164],
    [491, 170],
    [489, 177],
    [487, 184],
    [485, 190],
    [483, 196],
    [482, 202],
    [481, 208],
    [479, 214],
    [478, 221],
    [477, 227],
    [476, 232],
    [475, 237],
    [475, 240],
    [476, 243],
    [477, 246],
    [478, 248],
    [479, 251],
    [481, 253],
    [483, 255],
    [485, 257],
    [487, 258],
    [489, 259],
    [491, 260],
    [494, 260],
    [497, 259],
    [501, 258],
    [505, 256],
    [509, 253],
    [513, 250],
    [517, 247],
    [521, 243],
    [525, 239],
    [528, 234],
    [531, 228],
    [535, 222],
    [538, 215],
    [542, 207],
    [545, 199],
    [547, 192],
    [549, 186],
    [550, 180],
    [551, 175],
    [551, 171],
    [550, 167],
    [549, 164],
    [547, 160],
    [545, 157],
    [543, 153],
    [541, 150],
    [539, 147],
    [537, 144],
    [534, 142],
    [531, 141],
    [529, 141],
    [526, 140],
    [523, 140],
    [520, 140],
    [518, 140],
    [516, 140],
    [514, 140],
    [513, 140],
    [511, 140],
    [510, 140],
    [509, 140],
    [509, 141],
    [508, 141],
    [508, 142],
    [508, 143],
    [508, 144],
    [507, 145],
    [507, 146],
    [507, 148],
    [506, 149],
    [506, 151],
    [506, 152],
    [506, 154],
    [506, 155],
    [507, 157],
    [508, 158],
    [509, 159],
    [510, 161],
    [511, 162],
    [512, 163],
    [514, 164],
    [516, 164],
    [518, 165],
    [521, 165],
    [525, 165],
    [530, 164],
    [535, 163],
    [542, 159],
    [549, 154],
    [557, 148],
    [566, 142],
  ];
  class List {
    static create(initialCapacity = 16) {
      const list = new List(initialCapacity);
      return new Proxy(list, {
        get(target, prop) {
          if (typeof prop === "string" && /^\d+$/.test(prop)) {
            return target.get(parseInt(prop));
          }
          return target[prop];
        },
      });
    }

    constructor(initialCapacity = 16) {
      this.initialCapacity = initialCapacity;
      this._capacity = initialCapacity;
      this._buffer = new Array(initialCapacity).fill(null);
      this._head = Math.floor(initialCapacity / 2); // Start in the middle
      this._tail = this._head - 1;
      this.length = 0;
    }

    /**
     * Prepends an item to the beginning of the list
     * @param {*} item - Item to prepend
     * @returns {number} New length of the list
     */
    prepend(item) {
      if (this._head === 0) this._resize();
      this._buffer[--this._head] = item;
      return ++this.length;
    }

    /**
     * Appends an item to the end of the list
     * @param {*} item - Item to append
     * @returns {number} New length of the list
     */
    append(item) {
      if (this._tail === this._capacity - 1) this._resize();
      this._buffer[++this._tail] = item;
      return ++this.length;
    }

    pop() {
      if (this.length === 0) return undefined;
      const item = this._buffer[this._tail];
      this._buffer[this._tail] = null;
      this._tail--;
      this.length--;
      return item;
    }

    /**
     * Gets an item at the specified index
     * @param {number} index - Zero-based index
     * @returns {*} Item at the index or undefined if out of bounds
     */
    get(index) {
      if (index < 0 || index >= this.length) return undefined;
      return this._buffer[this._head + index];
    }

    /**
     * Sets an item at the specified index
     * @param {number} index - Zero-based index
     * @param {*} value - Value to set
     * @returns {boolean} True if successful, false if index out of bounds
     */
    set(index, value) {
      if (index < 0 || index >= this.length) return false;
      this._buffer[this._head + index] = value;
      return true;
    }

    /**
     * Clears the list
     */
    clear() {
      const initialCapacity = this.initialCapacity;
      this._capacity = initialCapacity;
      this._buffer = new Array(initialCapacity).fill(null);
      this._head = Math.floor(initialCapacity / 2);
      this._tail = this._head - 1;
      this.length = 0;
    }

    /**
     * Resizes the internal buffer when needed
     * @private
     */
    _resize() {
      const newCapacity = this._capacity * 2;
      const newBuffer = new Array(newCapacity).fill(null);
      const newHead = Math.floor((newCapacity - this.length) / 2);

      // Copy elements to the new buffer
      for (let i = 0; i < this.length; i++) {
        newBuffer[newHead + i] = this._buffer[this._head + i];
      }

      this._buffer = newBuffer;
      this._head = newHead;
      this._tail = this._head + this.length - 1;
      this._capacity = newCapacity;
    }

    [Symbol.iterator]() {
      let index = 0;
      const list = this;

      return {
        next() {
          if (index < list.length) {
            return { value: list.get(index++), done: false };
          } else {
            return { done: true };
          }
        },
      };
    }

    forEach(callback) {
      for (let i = 0; i < this.length; i++) {
        callback(this.get(i), i);
      }
    }

    map(callback) {
      const result = List.create(this.length);
      for (let i = 0; i < this.length; i++) {
        result.append(callback(this.get(i), i));
      }
      return result;
    }
  }
  // Calculate bounds of the original coordinates
  let minX = Infinity,
    maxX = -Infinity,
    minY = Infinity,
    maxY = -Infinity;
  coordinates.forEach((pt) => {
    if (pt[0] < minX) minX = pt[0];
    if (pt[0] > maxX) maxX = pt[0];
    if (pt[1] < minY) minY = pt[1];
    if (pt[1] > maxY) maxY = pt[1];
  });

  const designWidth = maxX - minX;
  const designHeight = maxY - minY;
  // Calculate the center of the original drawing
  const designCenterX = minX + designWidth / 2;
  const designCenterY = minY + designHeight / 2;

  // Create complex points from raw coordinates (no initial scaling)
  const complexPoints = coordinates.map((pt) => ({
    re: pt[0],
    im: pt[1],
  }));

  // Discrete Fourier Transform (DFT)
  function dft(x) {
    const N = x.length;
    const X = [];
    for (let k = 0; k < N; k++) {
      let re = 0,
        im = 0;
      for (let n = 0; n < N; n++) {
        const phi = (2 * Math.PI * k * n) / N;
        // Multiply by e^(-i*phi) = cos(phi) - i*sin(phi)
        re += x[n].re * Math.cos(phi) + x[n].im * Math.sin(phi);
        im += -x[n].re * Math.sin(phi) + x[n].im * Math.cos(phi);
      }
      re /= N;
      im /= N;
      const freq = k;
      const amp = Math.hypot(re, im);
      const phase = Math.atan2(im, re);
      X.push({ re, im, freq, amp, phase });
    }
    return X;
  }

  // Compute Fourier coefficients and sort by amplitude (largest first)
  let fourier = dft(complexPoints);
  fourier.sort((a, b) => b.amp - a.amp);

  // Animation state variables
  let time = 0;
  const dt = (2 * Math.PI) / fourier.length; // Time step per frame
  let path = List.create(fourier.length);
  const animationSpeed = 1; // Lower = slower, 1.0 = original speed
  let lastFrameTime = 0;
  let animationFrameId = null; // To manage the animation loop

  // Function to resize the canvas and handle DPI scaling
  function resizeCanvas() {
    // Stop previous animation frame request if any
    if (animationFrameId) {
      cancelAnimationFrame(animationFrameId);
    }

    // Use parent width for responsiveness (minus padding)
    // const containerPadding = 28; // Match your CSS padding * 2 or desired spacing
    const newWidth = canvasContainer.clientWidth;

    const newHeight = Math.min(newWidth * (2 / 3), window.innerHeight);

    // Set the CSS size for the element's layout
    canvas.style.width = newWidth + "px";
    canvas.style.height = newHeight + "px";

    // Set the drawing surface resolution (important!)
    // Use devicePixelRatio for sharper rendering on high-DPI screens
    const dpr = window.devicePixelRatio || 1;
    canvas.width = newWidth * dpr;
    canvas.height = newHeight * dpr;

    // Scale the context once here to compensate for devicePixelRatio
    // This ensures 1 CSS pixel corresponds to 1 drawing unit before our dynamic scaling
    ctx.resetTransform(); // Clear previous transforms before scaling
    ctx.scale(dpr, dpr);

    // Reset drawing state
    path.clear();
    time = 0;
    lastFrameTime = 0; // Reset last frame time for smooth start

    // Restart the animation loop
    animationFrameId = requestAnimationFrame(draw);
  }

  // Function to draw the set of vectors and update the traced path
  function draw(currentTime) {
    // Control frame rate based on timing (optional, remove if full speed is okay)
    if (lastFrameTime === 0) lastFrameTime = currentTime;
    const elapsed = currentTime - lastFrameTime;

    // Only update if enough time has passed (for slower animation)
    if (elapsed > 1000 / 60 / animationSpeed) {
      lastFrameTime = currentTime; // Uncomment if using frame rate limiting

      // Use CSS dimensions for drawing logic before DPR scaling
      const cssWidth = parseFloat(canvas.style.width) || canvas.width;
      const cssHeight = parseFloat(canvas.style.height) || canvas.height;

      // Clear the canvas (considering the DPR scaling applied in resizeCanvas)
      // We need to clear the *physical* pixel area
      ctx.save();
      ctx.resetTransform(); // Temporarily remove DPR scaling for clearRect
      ctx.fillStyle = "#111";
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.restore(); // Restore DPR scaling

      ctx.save(); // Save the DPR-scaled state

      // --- Scaling Logic ---
      // Calculate scale factors to fit the design within the CSS dimensions
      const scaleX = cssWidth / designWidth;
      const scaleY = cssHeight / designHeight;
      // Use the smaller scale factor to maintain aspect ratio and fit entirely
      // Multiply by a factor (e.g., 0.9) to add some padding
      const scale = Math.min(scaleX, scaleY) * 0.9;

      // Translate to the center of the CSS canvas dimensions
      ctx.translate(cssWidth / 2, cssHeight / 2);
      // Apply the calculated scale
      ctx.scale(scale, scale);
      // Translate the drawing's origin so its original center aligns with the canvas center
      ctx.translate(-designCenterX, -designCenterY);
      // --- End Scaling Logic ---

      let x = 0; // Start epicycles from the (now transformed) origin
      let y = 0;
      const baseLineWidth = 1; // Base line width in design coordinates

      // Draw each Fourier vector (each as a rotating circle and its arrow)
      for (let i = 0; i < fourier.length; i++) {
        let prevX = x;
        let prevY = y;
        const freq = fourier[i].freq;
        const radius = fourier[i].amp; // These amps are now relative to the design size
        const phase = fourier[i].phase;
        x += radius * Math.cos(freq * time + phase);
        y += radius * Math.sin(freq * time + phase);

        // Draw the circle (vector path)
        ctx.strokeStyle = "rgba(255, 255, 255, 0.3)";
        // Adjust line width based on scale so it looks consistent
        ctx.lineWidth = baseLineWidth / scale;
        ctx.beginPath();
        ctx.arc(prevX, prevY, radius, 0, 2 * Math.PI);
        ctx.stroke();

        // Draw the vector line
        ctx.strokeStyle = "#fff";
        ctx.lineWidth = baseLineWidth / scale; // Keep line width visually consistent
        ctx.beginPath();
        ctx.moveTo(prevX, prevY);
        ctx.lineTo(x, y);
        ctx.stroke();
      }

      // Add the final tip to the path (relative to the transformed origin)
      path.prepend({ x, y });
      // Optional: Limit path length for performance
      // if (path.length > 700) {
      // // Limit path length slightly longer than points
      // path.pop();
      // }

      // Draw the traced path
      ctx.beginPath();
      if (path.length > 0) {
        // Check if path has points
        ctx.moveTo(path[0].x, path[0].y);
        for (let i = 1; i < path.length; i++) {
          ctx.lineTo(path[i].x, path[i].y);
        }
        ctx.strokeStyle = "#ff4081"; // Pink color
        ctx.lineWidth = (baseLineWidth * 2) / scale; // Make path slightly thicker
        ctx.stroke();
      }

      ctx.restore(); // Restore the state before transformations for this frame

      // Increment time and loop if needed
      time += dt;
      if (time >= 2 * Math.PI) {
        time = time % (2 * Math.PI); // More robust loop than just setting to 0
        path.clear(); // Keep the last point for continuity instead of clearing fully
      }
    } // Uncomment if using frame rate limiting

    // Request the next frame
    animationFrameId = requestAnimationFrame(draw);
  }

  // Add resize listener
  window.addEventListener("resize", resizeCanvas);

  // Initial setup: size the canvas and start the animation
  resizeCanvas();
</script>

{{- partial "home_info.html" . }} {{- end }} {{- $term := .Data.Term }} {{-
range $index, $page := $paginator.Pages }} {{- $class := "post-entry" }} {{-
$user_preferred := or site.Params.disableSpecial1stPost
site.Params.homeInfoParams }} {{- if (and $.IsHome (eq $paginator.PageNumber 1)
(eq $index 0) (not $user_preferred)) }} {{- $class = "first-entry" }} {{- else
if $term }} {{- $class = "post-entry tag-entry" }} {{- end }}

<article class="{{ $class }}">
  {{- $isHidden := (.Param "cover.hiddenInList") | default (.Param
  "cover.hidden") | default false }} {{- partial "cover.html" (dict "cxt" .
  "IsSingle" false "isHidden" $isHidden) }}
  <header class="entry-header">
    <h2 class="entry-hint-parent">
      {{- .Title }} {{- if .Draft }}
      <span class="entry-hint" title="Draft">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="20"
          viewBox="0 -960 960 960"
          fill="currentColor"
        >
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z"
          />
        </svg>
      </span>
      {{- end }}
    </h2>
  </header>
  {{- if (ne (.Param "hideSummary") true) }}
  <div class="entry-content">
    <p>
      {{ .Summary | plainify | htmlUnescape }}{{ if .Truncated }}...{{ end }}
    </p>
  </div>
  {{- end }} {{- if not (.Param "hideMeta") }}
  <footer class="entry-footer">{{- partial "post_meta.html" . -}}</footer>
  {{- end }}
  <a
    class="entry-link"
    aria-label="post link to {{ .Title | plainify }}"
    href="{{ .Permalink }}"
  ></a>
</article>
{{- end }} {{- if gt $paginator.TotalPages 1 }}
<footer class="page-footer">
  <nav class="pagination">
    {{- if $paginator.HasPrev }}
    <a class="prev" href="{{ $paginator.Prev.URL | absURL }}">
      «&nbsp;{{ i18n "prev_page" }}&nbsp; {{- if (.Param "ShowPageNums") }} {{-
      sub $paginator.PageNumber 1 }}/{{ $paginator.TotalPages }} {{- end }}
    </a>
    {{- end }} {{- if $paginator.HasNext }}
    <a class="next" href="{{ $paginator.Next.URL | absURL }}">
      {{- i18n "next_page" }}&nbsp; {{- if (.Param "ShowPageNums") }} {{- add 1
      $paginator.PageNumber }}/{{ $paginator.TotalPages }} {{- end }}&nbsp;»
    </a>
    {{- end }}
  </nav>
</footer>
{{- end }} {{- end }}{{/* end profileMode */}} {{- end }}{{- /* end main */ -}}
